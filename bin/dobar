#!/usr/bin/env fish

set --erase crop_left
set --erase crop_right

if test -e .params.tryone
  echo reading parameters from two/.params.tryone
  set params (string split --no-empty -- ' ' (cat .params.tryone))
end

for bar in (fd --exact-depth 1 _[[:digit:]]{3}b.jpg)
  rm {$bar}
  if string match --quiet --regex -- '_(?<right>[[:digit:]]{3})b\.(jpg|png)' {$bar}
    set args {$params} (string trim --chars 0 --left -- {$right})
    doone {$args}
  end
  rm .params.tryone
end
