#!/usr/bin/env bash

nullglob=$(shopt -p nullglob); shopt -s nullglob extglob

if [ -z "$1" ]; then
    files=( *.@(avi|mkv|mov|mp4|wmv) )
else
    files=( )
    for arg in "$@"; do
        if [ -f "$arg" ]; then
            files+=( "$arg" )
        elif [ -d "$arg" ]; then
            files+=( "$arg"/*.@(avi|mkv|mov|mp4|wmv) )
        fi
    done
fi

if [ ${#files[@]} -gt 0 ]; then
    for file in "${files[@]}"; do
        name=$(ls -1 --quoting-style=shell-escape "${file}")
        dim=$(ffprobe -v error -select_streams v -show_entries stream=width,height -of csv=p=0:s=x "${file}")
        echo ${name}: ${dim}
    done
fi

$nullglob; unset nullglob
